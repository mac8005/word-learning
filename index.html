<!doctype html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Wort-Galaxie Trainer</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@500;700;800&family=Nunito:wght@500;700;900&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="app-shell">
      <header class="hero card">
        <div>
          <p class="eyebrow">Lernspiel</p>
          <h1>Wort-Galaxie Trainer</h1>
          <p class="subtitle">
            Höre genau zu, tippe das Wort und sammle Münzen für Tetris.
          </p>
        </div>
        <div class="coin-badge" id="coinBadge">Münzen: <strong id="coinCount">0</strong></div>
      </header>

      <main class="layout">
        <section class="card panel" id="setupPanel">
          <h2>Neues Wort-Set starten</h2>
          <div class="controls-grid">
            <label>
              Buchstabengruppe
              <select id="letterGroup">
                <option value="all">Wird geladen...</option>
              </select>
            </label>
            <label>
              Set-Groesse
              <select id="setSize">
                <option value="5">5 Wörter</option>
                <option value="10" selected>10 Wörter</option>
                <option value="15">15 Wörter</option>
                <option value="20">20 Wörter</option>
              </select>
            </label>
          </div>
          <button id="startBtn" class="btn primary">Mission starten</button>
          <p class="small-note">Tipp: Gross- und Kleinschreibung wird genau geprüft.</p>
        </section>

        <section class="card panel hidden" id="quizPanel">
          <div class="quiz-top">
            <h2>Schreibe, was du hörst</h2>
            <p id="progressText">Wort 1 / 10</p>
          </div>
          <div class="progress-track">
            <div class="progress-fill" id="progressFill"></div>
          </div>
          <div class="letter-slots" id="letterSlots"></div>
          <div class="quiz-controls">
            <button id="speakBtn" class="btn secondary">Wort vorlesen</button>
            <input
              id="wordInput"
              type="text"
              autocomplete="off"
              placeholder="Wort hier eingeben"
              aria-label="Gesprochenes Wort eingeben"
            />
            <button id="nextBtn" class="btn primary">Nächstes Wort</button>
          </div>
          <p id="quizFeedback" class="feedback"></p>
        </section>

        <section class="card panel hidden" id="resultPanel">
          <h2>Missionsergebnis</h2>
          <div class="result-highlight">
            <div class="rating" id="ratingLabel">Wort-Held</div>
            <div class="score-line" id="scoreLine">8 / 10 richtig</div>
            <div class="score-line" id="coinRewardLine">+20 Münzen erhalten</div>
          </div>
          <div id="mistakesBlock">
            <h3>Fehler-Labor</h3>
            <p>Korrigiere die falschen Wörter und hole Bonus-Münzen.</p>
            <div id="mistakesList"></div>
            <button id="checkCorrectionsBtn" class="btn primary">Korrekturen prüfen</button>
            <p id="correctionFeedback" class="feedback"></p>
          </div>
          <button id="playAgainBtn" class="btn secondary">Neues Set spielen</button>
        </section>

        <section class="card panel arcade-card" id="miniGamePanel">
          <div class="arcade-header">
            <h2>Bonus-Spiel: Tetris</h2>
            <span class="ticket-badge">Spiele: <strong id="tetrisPlays">0</strong></span>
          </div>
          <p class="small-note">
            Trainiere Wörter, sammle 20 Münzen und spiele 1 Runde Tetris.
          </p>
          <div class="arcade-actions">
            <button id="buyTetrisPlaysBtn" class="btn arcade-buy">
              1 Spiel für 20 Münzen kaufen
            </button>
            <button id="openTetrisBtn" class="btn arcade-play">
              Tetris öffnen
            </button>
          </div>
          <p id="miniGameFeedback" class="feedback"></p>
        </section>
      </main>
    </div>

    <!-- Tetris Modal -->
    <div class="tetris-modal-backdrop hidden" id="tetrisModalBackdrop">
      <div class="tetris-modal" id="tetrisModal">
        <div class="tetris-modal-header">
          <h2 class="tetris-modal-title">Tetris</h2>
          <div class="tetris-modal-badges">
            <span class="tetris-badge coin-inline" id="tetrisCoins">Münzen: 0</span>
            <span class="tetris-badge ticket-inline">Spiele: <strong id="tetrisPlaysModal">0</strong></span>
          </div>
          <button class="tetris-close-btn" id="closeTetrisBtn" aria-label="Schliessen">&times;</button>
        </div>
        <div class="tetris-modal-body">
          <div class="tetris-stage">
            <div class="tetris-stats-col">
              <div class="tetris-stat-box">
                <span class="tetris-stat-label">Punkte</span>
                <span class="tetris-stat-value" id="tetrisScore">0</span>
              </div>
              <div class="tetris-stat-box">
                <span class="tetris-stat-label">Linien</span>
                <span class="tetris-stat-value" id="tetrisLines">0</span>
              </div>
              <div class="tetris-stat-box">
                <span class="tetris-stat-label">Level</span>
                <span class="tetris-stat-value" id="tetrisLevel">1</span>
              </div>
              <div class="tetris-stat-box next-piece-box">
                <span class="tetris-stat-label">Nächstes</span>
                <canvas id="nextPieceCanvas" class="next-piece-canvas" width="96" height="96"></canvas>
              </div>
            </div>
            <div class="tetris-canvas-wrapper">
              <canvas
                id="tetrisCanvas"
                class="tetris-canvas"
                width="240"
                height="480"
                aria-label="Tetris Spielfeld"
              ></canvas>
              <div class="tetris-glow"></div>
            </div>
          </div>
          <div class="tetris-controls">
            <button id="startMiniGameBtn" class="btn tetris-btn-start">Tetris starten</button>
            <button id="pauseMiniGameBtn" class="btn tetris-btn-pause">Pause</button>
          </div>
          <p class="tetris-hint">← → bewegen &middot; ↑ drehen &middot; ↓ schneller &middot; Leertaste fallen</p>
          <p id="tetrisModalFeedback" class="feedback tetris-feedback"></p>
        </div>
      </div>
    </div>

    <script src="app.js"></script>
  </body>
</html>
